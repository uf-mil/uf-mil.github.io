<!DOCTYPE html>
<!-- Some pieces of this template were used from https://github.com/Rapptz/discord.py/blob/master/docs/_templates/layout.html -->
<html>
    <head>
        <!-- HTML meta -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale: 1.0">
        <title>mil_vision_tools.color_classifier</title>
        <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
        <link rel="stylesheet" href="../../_static/codeblocks.css" type="text/css" />
        <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
        <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../searchindex.js" defer></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/custom.js"></script>
        <script src="../../_static/sidebar.js"></script>
        <script src="../../_static/lightdarkmode.js"></script>
        <link rel="shortcut icon" href="../../_static/mil_white.svg"/>
        <link rel="index" title="Index" href="../../genindex.html" />
        <link rel="search" title="Search" href="../../search.html" />
    </head>
    <body>
        <div class="main-grid">
            <header class="grid-item">
                <nav>
                    <a class="main-heading" href="../../index.html">Machine Intelligence Lab</a>
                    <div id="mil-light-dark-icon" onClick="rotateLightDark();">
                        <span class="material-icons" title=""></span>
                    </div>
                    <a href="https://github.com/uf-mil/mil" target="_blank"><img class="mil-svg" src="../../_static/github.svg" /></a>
                    <a href="https://mil.ufl.edu" target="_blank"><img class="mil-svg" src="../../_static/mil.svg" /></a>
                </nav>
            </header>
            <aside class="grid-item">
                <span id="hamburger-toggle">
                    <span class="material-icons">menu</span>
                </span>
                <div id="sidebar"><form id="search-form" role="search" class="search" action="../../search.html" method="get">
    <div class="search-wrapper">
        <input type="search" name="q" placeholder="Search documentation" />
        <button type="submit" onmousedown="searchBarClick(event, document.getElementById('search-form'));">
            <span class="material-icons">search</span>
        </button>
    </div>
</form>
<h3><a href="../../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../welcome.html">Welcome to MIL!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mechanical/index.html">Mechanical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../electrical/index.html">Electrical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/index.html">Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subjugator/index.html">SubjuGator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../navigator/index.html">NaviGator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Software Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subjugator/reference.html">Subjugator Software Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../navigator/reference.html">Navigator Software Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design/design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../infrastructure/index.html">Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../culture.html">Culture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../branding.html">Branding</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../testingprocedures.html">Testing Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deprecated.html">Deprecated Projects</a></li>
</ul>

                </div>
            </aside>
            <main class="grid-item" role="main">
                
  <h1>Source code for mil_vision_tools.color_classifier</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span><span class="p">,</span> <span class="n">abstractmethod</span><span class="p">,</span> <span class="n">abstractproperty</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.typing</span> <span class="k">as</span> <span class="nn">npt</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>

<span class="kn">from</span> <span class="nn">.cv_tools</span> <span class="kn">import</span> <span class="n">contour_mask</span>
<span class="kn">from</span> <span class="nn">.labelbox_parser</span> <span class="kn">import</span> <span class="n">LabelBoxParser</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Kevin Allen&quot;</span>


<span class="k">def</span> <span class="nf">_get_param</span><span class="p">(</span><span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helpers function to get whichever param is not None, used</span>
<span class="sd">    to have class defaults which can be overridden in function calls</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">one</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">two</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;both params are None&quot;</span>
    <span class="k">return</span> <span class="n">two</span> <span class="k">if</span> <span class="n">one</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">one</span>


<div class="viewcode-block" id="ContourClassifier"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier">[docs]</a><span class="k">class</span> <span class="nc">ContourClassifier</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract class to represent a classifier for contours within images.</span>

<span class="sd">    See GaussianColorClassifier for an example.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        classes (List[:class:`str`]): A list of class names (as strings),</span>
<span class="sd">            for example: ``[&#39;red&#39;, &#39;white&#39;, &#39;blue&#39;]``.</span>
<span class="sd">        training_file (Optional[:class:`str`]): The name of the training file.</span>
<span class="sd">        labelfile (Optional[:class:`str`]): The file containing the labels.</span>
<span class="sd">        image_dir (Optional[:class:`str`]): The directory containing the images.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">ABCMeta</span>  <span class="c1"># Treat</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">classes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">training_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">labelfile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">image_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">training_file</span> <span class="o">=</span> <span class="n">training_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labelfile</span> <span class="o">=</span> <span class="n">labelfile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_dir</span> <span class="o">=</span> <span class="n">image_dir</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@abstractproperty</span>
    <span class="k">def</span> <span class="nf">FEATURES</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For concrete classes, must return a list of strings naming the features</span>
<span class="sd">        returned by get_features.</span>

<span class="sd">        For example, an example overload might return ``[&#39;red_mean&#39;, &#39;blue_mean&#39;, &#39;green_mean&#39;]``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="bp">NotImplemented</span><span class="p">()</span>

<div class="viewcode-block" id="ContourClassifier.get_features"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.get_features">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">mask</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an array of numerical features based on on the image and contour mask.</span>
<span class="sd">        This should be implemented in all child classes.</span>

<span class="sd">        Args:</span>
<span class="sd">            img (np.ndarray): The 2D image to get the features of.</span>
<span class="sd">            mask (np.ndarray): The contour mask to apply over the image.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: An array of numerical features found.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="ContourClassifier.classify_features"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.classify_features">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">classify_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For concrete classes, classify a contour based on it&#39;s set of features</span>
<span class="sd">        returned from get_features.</span>

<span class="sd">        Args:</span>
<span class="sd">            features (np.ndarray): a list of numerical features in the order</span>
<span class="sd">                returned by :meth:`.get_features`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The index of the class which is the most probabable classification</span>
<span class="sd">            based on the features.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="ContourClassifier.feature_probabilities"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.feature_probabilities">[docs]</a>    <span class="k">def</span> <span class="nf">feature_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows child classes to give probabilties for each possible class given</span>
<span class="sd">        a features vector, instead of just one classification. By default,</span>
<span class="sd">        gives 1.0 to classified class and 0.0 to others.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[float]: The list of probabilities. Each member ranges from 0 to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">)</span>
        <span class="n">classification</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify_features</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="n">probabilities</span><span class="p">[</span><span class="n">classification</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">return</span> <span class="n">probabilities</span></div>

<div class="viewcode-block" id="ContourClassifier.train"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.train">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">classes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        For concrete classes, train the classifier based on the set of features</span>
<span class="sd">        and their labeled class index.</span>

<span class="sd">        Args:</span>
<span class="sd">            features (np.ndarray): Array with shape ``(n_samples, m_features)``,</span>
<span class="sd">                where each row is a list of features in the order returned from</span>
<span class="sd">                :meth:`.get_features`.</span>
<span class="sd">            classes (np.ndarray): List with shape ``(n_samples)`` of labeled class index</span>
<span class="sd">                corresponding to each row of features.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="ContourClassifier.score"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.score">[docs]</a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">classes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the classification accuracy based on the set of features and</span>
<span class="sd">        labeled class indices.</span>

<span class="sd">        Args:</span>
<span class="sd">            features (np.ndarray): Array of shape ``(n_samples, m_features)``, where each row is a list of features.</span>
<span class="sd">            classes (np.ndarray): Array of shape ``(n_samples)`` with labeled class indices.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A proportion accuracy correct_classificiations / len(classes).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
        <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">classification</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify_features</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">classification</span> <span class="o">==</span> <span class="n">classes</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">correct</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span></div>

<div class="viewcode-block" id="ContourClassifier.string_to_class"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.string_to_class">[docs]</a>    <span class="k">def</span> <span class="nf">string_to_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strings</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Maps a single string or list of strings representing a class in the set</span>
<span class="sd">        of those passed to the constructor to the corresponding integer index</span>
<span class="sd">        representing this class, used in most functions for training / classification.</span>

<span class="sd">        Args:</span>
<span class="sd">            strings (Union[List[str], str]): The string or list of strings to return</span>
<span class="sd">                the index of.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[List[int], int]: The list of indexes (if multiple strings are passed),</span>
<span class="sd">            or the single index if only one string is passed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">strings</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">strings</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContourClassifier.class_to_string"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.class_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">class_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Maps a single integer or list of integers representing a class index to</span>
<span class="sd">        the corresponding class string in the set of those passed to the constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            classes (Union[List[int], int]): The list of indexes to find the associated</span>
<span class="sd">                classes of. Otherwise, the name of one class to find one index of.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[List[str], str]: The list of found classes or the one found class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">,</span> <span class="n">classes</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="n">classes</span><span class="p">]</span></div>

<div class="viewcode-block" id="ContourClassifier.classify"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.classify">[docs]</a>    <span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">mask</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Classify a contour.</span>

<span class="sd">        Args:</span>
<span class="sd">            img (np.ndarray): 2D image representation.</span>
<span class="sd">            mask (np.ndarray): Binary mask image representing the contour.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The class index this is most probable given the features in that contour.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classify_features</span><span class="p">(</span><span class="n">features</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContourClassifier.probabilities"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.probabilities">[docs]</a>    <span class="k">def</span> <span class="nf">probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">mask</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a vector of probabilities of the features retrieved from the contour with</span>
<span class="sd">        given mask corresponding to the class list.</span>

<span class="sd">        Args:</span>
<span class="sd">            img (np.ndarray): 2D image representation.</span>
<span class="sd">            mask (np.ndarray): Binary mask image representing the contour.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[float]: The list of probabilities across the entire image.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_probabilities</span><span class="p">(</span><span class="n">features</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContourClassifier.read_from_csv"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.read_from_csv">[docs]</a>    <span class="k">def</span> <span class="nf">read_from_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return features and classes from specified training file.</span>

<span class="sd">        Args:</span>
<span class="sd">            training_file (Optional[str]): The name of the training file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">training_file</span> <span class="o">=</span> <span class="n">_get_param</span><span class="p">(</span><span class="n">training_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_file</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">training_file</span><span class="p">)</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">features</span><span class="p">,</span> <span class="n">classes</span></div>

<div class="viewcode-block" id="ContourClassifier.train_from_csv"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.train_from_csv">[docs]</a>    <span class="k">def</span> <span class="nf">train_from_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Train the classifier given the labeled feature found in filename</span>
<span class="sd">        which should be in the format obtained from :meth:`.save_csv`.</span>

<span class="sd">        Args:</span>
<span class="sd">            training_file (Optional[str]): The name of the training file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">training_file</span> <span class="o">=</span> <span class="n">_get_param</span><span class="p">(</span><span class="n">training_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_file</span><span class="p">)</span>
        <span class="n">features</span><span class="p">,</span> <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_from_csv</span><span class="p">(</span><span class="n">training_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContourClassifier.save_csv"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.save_csv">[docs]</a>    <span class="k">def</span> <span class="nf">save_csv</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">features</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>
        <span class="n">classes</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>
        <span class="n">training_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the features and labeled classes to a csv file</span>
<span class="sd">        to be used in later training.</span>

<span class="sd">        Args:</span>
<span class="sd">            features (npt.ArrayLike): The features found.</span>
<span class="sd">            classes (npt.ArrayLike): The classes used in the classifier.</span>
<span class="sd">            training_file (Optional[str]): The name of the file to save the data as.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">training_file</span> <span class="o">=</span> <span class="n">_get_param</span><span class="p">(</span><span class="n">training_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_file</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="n">classes</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">classes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">classes</span><span class="p">,</span> <span class="n">features</span><span class="p">))</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Class&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">FEATURES</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">training_file</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContourClassifier.extract_labels"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.extract_labels">[docs]</a>    <span class="k">def</span> <span class="nf">extract_labels</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">labelfile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">image_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract features and labeled classes from a project labeled on labelbox.io.</span>

<span class="sd">        Args:</span>
<span class="sd">            labelfile (Optional[str]): the json file containing the labels for the project</span>
<span class="sd">            image_dir (Optional[str]): directory where source images for the project can be found</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: No labels were found.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[np.ndarray, np.ndarray]: Tuple of the features found and classes found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">labelfile</span> <span class="o">=</span> <span class="n">_get_param</span><span class="p">(</span><span class="n">labelfile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labelfile</span><span class="p">)</span>
        <span class="n">image_dir</span> <span class="o">=</span> <span class="n">_get_param</span><span class="p">(</span><span class="n">image_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_dir</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">labelfile</span><span class="p">,</span> <span class="n">image_dir</span><span class="p">)</span>
        <span class="n">labler</span> <span class="o">=</span> <span class="n">LabelBoxParser</span><span class="p">(</span><span class="n">labelfile</span><span class="p">,</span> <span class="n">image_dir</span><span class="p">)</span>
        <span class="n">label_features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">label_classes</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">labeled_img_cb</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">img</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">label</span><span class="p">[</span><span class="s2">&quot;Label&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">single_label</span> <span class="ow">in</span> <span class="n">label</span><span class="p">[</span><span class="s2">&quot;Label&quot;</span><span class="p">][</span><span class="n">l</span><span class="p">]:</span>
                        <span class="n">points</span> <span class="o">=</span> <span class="n">LabelBoxParser</span><span class="o">.</span><span class="n">label_to_contour</span><span class="p">(</span>
                            <span class="n">single_label</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="p">)</span>
                        <span class="n">mask</span> <span class="o">=</span> <span class="n">contour_mask</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
                        <span class="n">label_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
                        <span class="n">label_classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>

        <span class="n">labler</span><span class="o">.</span><span class="n">get_labeled_images</span><span class="p">(</span><span class="n">labeled_img_cb</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label_features</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No labels found. Please check parameters&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">label_features</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">label_classes</span><span class="p">)</span></div>

<div class="viewcode-block" id="ContourClassifier.main"><a class="viewcode-back" href="../../reference/vision.html#mil_vision_tools.ContourClassifier.main">[docs]</a>    <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Interface with a contour classifier class&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows execution of the class from a command-line interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--training-file&quot;</span><span class="p">,</span>
            <span class="s2">&quot;-t&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;CSV file to save/load training features and label to.&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">subparser</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">()</span>
        <span class="n">extract</span> <span class="o">=</span> <span class="n">subparser</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span><span class="s2">&quot;extract&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Extract labels&quot;</span><span class="p">)</span>
        <span class="n">extract</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;extract&quot;</span><span class="p">)</span>
        <span class="n">extract</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--label-file&quot;</span><span class="p">,</span>
            <span class="s2">&quot;-l&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path of json file containing labelbox labels&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">extract</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
            <span class="s2">&quot;--image-dir&quot;</span><span class="p">,</span>
            <span class="s2">&quot;-d&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to directory containing images for datasets labeled by label file&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">subparser</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
            <span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Print a accuracy score based on saved training file&quot;</span>
        <span class="p">)</span>
        <span class="n">score</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;score&quot;</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cmd</span> <span class="o">==</span> <span class="s2">&quot;extract&quot;</span><span class="p">:</span>
            <span class="n">features</span><span class="p">,</span> <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_labels</span><span class="p">(</span>
                <span class="n">labelfile</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">label_file</span><span class="p">,</span> <span class="n">image_dir</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">image_dir</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_csv</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">training_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">training_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">cmd</span> <span class="o">==</span> <span class="s2">&quot;score&quot;</span><span class="p">:</span>
            <span class="n">features</span><span class="p">,</span> <span class="n">classes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_from_csv</span><span class="p">(</span><span class="n">training_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">training_file</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">features</span><span class="p">,</span><span class="w"> </span><span class="n">classes</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">GaussianColorClassifier</span><span class="p">(</span><span class="n">ContourClassifier</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A contour classifier which classifies a contour</span>
<span class="sd">    based on it&#39;s mean color in BGR, HSV, and LAB colorspaces,</span>
<span class="sd">    using a Gaussian classifier for these features.</span>

<span class="sd">    For more usage info, see the ContourClassifier class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FEATURES</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">):</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">mean</span><span class="p">[:</span><span class="mi">3</span><span class="p">]]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
        <span class="n">mean_hsv</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2HSV</span><span class="p">)</span>
        <span class="n">mean_lab</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2LAB</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">mean</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">mean_hsv</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">mean_lab</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">features</span>

    <span class="k">def</span> <span class="nf">classify_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">feature_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">classes</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>
</pre></div>

            </main>
        </div>
    </body>
</html>