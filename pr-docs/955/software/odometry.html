<!DOCTYPE html>
<!-- Some pieces of this template were used from https://github.com/Rapptz/discord.py/blob/master/docs/_templates/layout.html -->
<html>
    <head>
        <!-- HTML meta -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale: 1.0">
        <title>Basic Movement and Odometry</title>
        <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
        <link rel="stylesheet" href="../_static/codeblocks.css" type="text/css" />
        <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
        <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../searchindex.js" defer></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/custom.js"></script>
        <script src="../_static/sidebar.js"></script>
        <script src="../_static/lightdarkmode.js"></script>
        <link rel="shortcut icon" href="../_static/mil_white.svg"/>
        <link rel="index" title="Index" href="../genindex.html" />
        <link rel="search" title="Search" href="../search.html" />
        <link rel="next" title="Noetic Migration" href="noetic_migration.html" />
        <link rel="prev" title="Python Style Guide" href="python_style.html" />
    </head>
    <body>
        <div class="main-grid">
            <header class="grid-item">
                <nav>
                    <a class="main-heading" href="../index.html">Machine Intelligence Lab</a>
                    <div id="mil-light-dark-icon" onClick="rotateLightDark();">
                        <span class="material-icons" title=""></span>
                    </div>
                    <a href="https://github.com/uf-mil/mil" target="_blank"><img class="mil-svg" src="../_static/github.svg" /></a>
                    <a href="https://mil.ufl.edu" target="_blank"><img class="mil-svg" src="../_static/mil.svg" /></a>
                </nav>
            </header>
            <aside class="grid-item">
                <span id="hamburger-toggle">
                    <span class="material-icons">menu</span>
                </span>
                <div id="sidebar"><form id="search-form" role="search" class="search" action="../search.html" method="get">
    <div class="search-wrapper">
        <input type="search" name="q" placeholder="Search documentation" />
        <button type="submit" onmousedown="searchBarClick(event, document.getElementById('search-form'));">
            <span class="material-icons">search</span>
        </button>
    </div>
</form>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../welcome.html">Welcome to MIL!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mechanical/index.html">Mechanical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../electrical/index.html">Electrical</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Software</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="devtools.html">Developer Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation_syntax.html">Documentation Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="adding_documentation.html">Updating Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="help.html">Getting Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="zobelisk.html">Accessing Zobelisk</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio.html">An Introduction to Asyncio</a></li>
<li class="toctree-l2"><a class="reference internal" href="rostest.html">Writing Unit Tests with <code class="docutils literal notranslate"><span class="pre">rostest</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="bash_style.html">Bash Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="cpp_style.html">C++ Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="python_style.html">Python Style Guide</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Basic Movement and Odometry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#covariance">Covariance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#derivation">Derivation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-odometry">Using Odometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-movement">Basic Movement</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#c3-trajectory-generator">C3 Trajectory Generator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adaptive-controller">Adaptive Controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="#thruster-mapper">Thruster Mapper</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submove-the-end-goal"><code class="docutils literal notranslate"><span class="pre">submove</span></code> - The End Goal</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="noetic_migration.html">Migrating to ROS Noetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="rtx_2080_drivers.html">Installing NVIDIA Drivers for RTX 2080</a></li>
<li class="toctree-l2"><a class="reference internal" href="apple_mseries_ubuntu_setup.html">Installing Ubuntu 18.04 on an M-series Apple computer</a></li>
<li class="toctree-l2"><a class="reference internal" href="resetubuntupass.html">Resetting Ubuntu Administrative Password</a></li>
<li class="toctree-l2"><a class="reference internal" href="../infrastructure/network.html">Network with Vehicles and Simulation Servers</a></li>
<li class="toctree-l2"><a class="reference internal" href="calibrating_cams.html">Calibrating Cameras</a></li>
<li class="toctree-l2"><a class="reference internal" href="submodule.html">Developing with Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="extension_support.html">Optional Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="scripts.html">Helpful Scripts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../subjugator/index.html">SubjuGator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../navigator/index.html">NaviGator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Software Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../subjugator/reference.html">Subjugator Software Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../navigator/reference.html">Navigator Software Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/index.html">Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../culture.html">Culture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../branding.html">Branding</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testingprocedures.html">Testing Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deprecated.html">Deprecated Projects</a></li>
</ul>

                </div>
            </aside>
            <main class="grid-item" role="main">
                
  <section id="basic-movement-and-odometry">
<h1>Basic Movement and Odometry<a class="headerlink" href="#basic-movement-and-odometry" title="Permalink to this heading">¶</a></h1>
<p>All of our robots use a method of position estimation known as odometry.
Odometry is the process of integrating multiple sources of information to
determine the robot’s position relative to where it started. This system allows
a robot to make very precise movements based on its idea of its position.</p>
<p>This technique produces an odometry reading, commonly represented by the
<a class="reference internal" href="../reference/messages.html#nav_msgs.msg.Odometry" title="nav_msgs.msg.Odometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">nav_msgs.msg.Odometry</span></code></a> ROS message type. This message type contains a
pose, the robot’s current position and orientation, and a twist, the robot’s
current linear and angular velocity.</p>
<p>But, why not a method like GPS? After all, that is how many electronic devices
(for example,a  GPS) get a representation of their position. The two major
flaws with this approach include the fact that GPS is not very accurate, and
the fact that using one source of information is weaker than using multiple
sources of information. Furthermore, GPS can’t penetrate water! So, no GPS
capabilities for a robot like SubjuGator. <em>sad face</em></p>
<section id="covariance">
<h2>Covariance<a class="headerlink" href="#covariance" title="Permalink to this heading">¶</a></h2>
<p>When viewing odometry readings in ROS, you will notice another measurement:
covariance. This is a 36-value covariance matrix, showing the covariance
between 6 unique values: x, y, z, rotation about the X, rotation about the Y,
and rotation about the Z. The covariance is indicated between each of the
values - for example, the first element in the array is the covariance between
x and x, the next element is the covariance between x and y, etc. These
covariance values indicate the relationship between two unique variables.
Positive covariance values indicate that there is a positive linear
correlation, ie, as one of the variables increases, the other is expected to
increase alongside it (vice versa, for a negative covariance value).
Furthermore, the higher the covariance value, the closer the two variables
change together.</p>
<p>But, why are these covariance values here? If you read them yourself, it can
look like random noise. Interestingly, these covariance values hold some
interesting information if you know how to compute statistics on them properly.
One application of these values is error ellipses. These error ellipses
indicate the perceived error in a particular measurement - the bigger the
ellipse, the more error perceived. This concept is similar to confidence
ellipses, which aim to highlight the perceived confidence in a particular
measurement. Be careful to not confuse these two values!</p>
<p>In practice, however, these values are rarely used outside of the Kalman filter
calculations.</p>
</section>
<section id="derivation">
<h2>Derivation<a class="headerlink" href="#derivation" title="Permalink to this heading">¶</a></h2>
<p>How does odometry get derived? As mentioned earlier, multiple source of
information are taken into account. How this is done varies by each robot.</p>
<p>For SubjuGator, these sources get put through an extended Kalman filter, known
as the <a class="reference internal" href="../design/odom_estimator/odom_estimator.html"><span class="doc std std-doc"><code class="docutils literal notranslate"><span class="pre">odom_estimator</span></code></span></a>, originally
designed by MIL member Forest Voight. This estimator, written in C++, combines
information from the Doppler Velocity Log (DVL), Inertial Measurement Unit
(IMU), and a depth sensor. The accelerometer, magnetometer, and gyroscope
measurements are used from the IMU. This Kalman filter is quiet powerful,
especially when eliminating errors. Sensors including the inertial measurement
unit (IMU) build up error over time, however, this error is eliminated through
the Kalman filter.</p>
<p>Furthermore, a small amount of redundancy is built into the Kalman filter. The
filter is able to record knowledge about which DVL beam failed; it can use this
information to operate on only one or two DVL beams.</p>
</section>
<section id="using-odometry">
<h2>Using Odometry<a class="headerlink" href="#using-odometry" title="Permalink to this heading">¶</a></h2>
<p>With all of the information contained in a single odometry reading, odometry is
quite a powerful message type. Therefore, odometry is used by several systems,
including the transforms system (so other transforms can reference the robot’s
updated position), the alarm server (to kill the robot if it moves into a
dangerous position), and the mission system (to move the robot according to a
high-level plan).</p>
<p>Odometry is also useful for debugging the robot. Odometry can be quickly viewed
using the <code class="docutils literal notranslate"><span class="pre">rostopic</span> <span class="pre">echo</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rostopic <span class="nb">echo</span> /odom
</pre></div>
</div>
</section>
<section id="basic-movement">
<h2>Basic Movement<a class="headerlink" href="#basic-movement" title="Permalink to this heading">¶</a></h2>
<p>Awesome, now that we understand some basics about how odometry is derived, how
can we use this reading to move our robot? Each robot does this differently, as
well. For SubjuGator, this is the job of the C3 Trajectory Generator, a system
to plan out trajectories in a C3 state space (three-dimensional state space).
This system generates the trajectories for SubjuGator; these trajectories are
then sent to the sub’s adaptive controller system, which turns the trajectories
into actual movements.</p>
<section id="c3-trajectory-generator">
<h3>C3 Trajectory Generator<a class="headerlink" href="#c3-trajectory-generator" title="Permalink to this heading">¶</a></h3>
<p>The C3 trajectory generator, written in C++, is a small ROS package which
implements an <a class="reference external" href="http://wiki.ros.org/actionlib">action server</a> under the
namespace <code class="docutils literal notranslate"><span class="pre">moveto</span></code> (not to be confused with <code class="docutils literal notranslate"><span class="pre">move_to</span></code>, the namespace used by
NaviGator’s action server). This server can be sent goals by various systems,
and the trajectory generator will continuously figure out the most optimal path
to the point until the point has been reached.</p>
</section>
<section id="adaptive-controller">
<h3>Adaptive Controller<a class="headerlink" href="#adaptive-controller" title="Permalink to this heading">¶</a></h3>
<p>SubjuGator’s adaptive controller is a single Python file which listens to the
trajectory messages sent by the trajectory generator.</p>
</section>
<section id="thruster-mapper">
<h3>Thruster Mapper<a class="headerlink" href="#thruster-mapper" title="Permalink to this heading">¶</a></h3>
<p>Great! We now have a wrench message describing the goal force and torque to be
exerted on the robot! But, we still need to actually power the individual
motors to achieve this goal. This is where the thruster mapper comes in - the
goal of the thruster mapper is to do exactly this.</p>
</section>
</section>
<section id="submove-the-end-goal">
<h2><code class="docutils literal notranslate"><span class="pre">submove</span></code> - The End Goal<a class="headerlink" href="#submove-the-end-goal" title="Permalink to this heading">¶</a></h2>
<p>At the end of all of this, we are able to move the sub along any of its degrees
of freedom using the <code class="docutils literal notranslate"><span class="pre">submove</span></code> command. This interface allows us to change the
pitch, roll, yaw of the robot, alongside its orientation in the x, y, and z
directions. Having a high-level interface like this makes missions easier to
write, and demonstrations cooler!</p>
</section>
</section>


            </main>
        </div>
    </body>
</html>